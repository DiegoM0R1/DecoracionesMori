{% extends "base.html" %}
{% load static %}

{% block title %} - Inicio{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">
{% endblock %}

{% block content %}

<!-- Sección Hero -->
<section class="hero-section">
    <div class="hero-carousel carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            {% for image in carousel_images %}
                <button type="button" data-bs-target=".hero-carousel" data-bs-slide-to="{{ forloop.counter0 }}" 
                        {% if forloop.first %}class="active" aria-current="true"{% endif %} 
                        aria-label="Slide {{ forloop.counter }}"></button>
            {% empty %}
                <button type="button" data-bs-target=".hero-carousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target=".hero-carousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target=".hero-carousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
            {% endfor %}
        </div>
        <div class="carousel-inner">
            {% for image in carousel_images %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <img src="{{ image.image.url }}" class="d-block w-100" alt="{{ image.title }}">
                    <div class="carousel-caption">
                        <h1>{{ image.title }}</h1>
                        <p>{{ image.subtitle }}</p>
                        {% if image.button_text and image.button_url %}
                            <a href="{{ image.button_url }}" class="btn btn-primary btn-lg">{{ image.button_text }}</a>
                        {% else %}
                            <a href="{% url 'services:service_list' %}" class="btn btn-primary btn-lg">{{ image.button_text }}</a>
                        {% endif %}
                    </div>
                </div>
            {% empty %}
                <!-- Contenido por defecto si no hay imágenes en el admin -->
                <div class="carousel-inner">
                    <img src="{% static 'imagen/slider1.jpg' %}" class="d-block w-100" alt="DecoracionesMori">
                    <div class="carousel-caption">
                        <h1>Bienvenido a Decoraciones Mori</h1>
                        <p>Servicios de limpieza, instalación y decoración de primera calidad</p>
                        <a href="{% url 'services:service_list' %}" class="btn btn-primary btn-lg">Ver Servicios</a>
                    </div>
                </div>

                <div class="carousel-item">
                    <img src="{% static 'imagen/slider2.jpg' %}" class="d-block w-100" alt="Limpieza">
                    <div class="carousel-caption">
                        <h1>Servicios de Limpieza Profesional</h1>
                        <p>Limpieza de colchones, muebles, alfombras y más</p>
                        <a href="{% url 'services:service_list' %}" class="btn btn-primary btn-lg">Ver Detalles</a>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="{% static 'imagen/slider3.jpg' %}" class="d-block w-100" alt="Instalaciones">
                    <div class="carousel-caption">
                        <h1>Instalaciones Profesionales</h1>
                        <p>Cortinas, alfombras, pisos y más</p>
                        <a href="{% url 'services:service_list' %}" class="btn btn-primary btn-lg">Ver Detalles</a>
                    </div>
                </div>
            {% endfor %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target=".hero-carousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target=".hero-carousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Siguiente</span>
        </button>
    </div>
</section>

<!-- Sección de Resumen de Servicios -->
<section class="services-overview py-5">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-12">
                <h2 class="section-title">Categorías de Servicios</h2>
                <p class="section-subtitle">Explora nuestras diferentes categorías de servicios</p>
            </div>
        </div>
        
        <div class="row">
            {% for item in categories_with_service %}
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100">
                    {% with featured_image=item.service.get_featured_image %}
                        {# Contenedor para mantener altura y estilo consistentes con tu CSS (.service-card img { height: 220px; }) #}
                        <div class="card-img-top-container" style="height: 220px; overflow: hidden; background-color: #eee; border-top-left-radius: 0.8rem; border-top-right-radius: 0.8rem;">
                            {% if featured_image %}
                                {% if featured_image.image_url %}
                                    {# Renderizar el embed code (iframe) #}
                                    {{ featured_image.image_url|safe }}
                                {% elif featured_image.image %}
                                    {# Renderizar la imagen subida #}
                                    <img src="{{ featured_image.image.url }}" class="card-img-top" alt="{{ item.category.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                                {% else %}
                                    {# Placeholder por defecto si featured_image existe pero no tiene fuente #}
                                    <img src="{% static 'imagen/default-service.jpg' %}" class="card-img-top" alt="{{ item.category.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                                {% endif %}
                            {% else %}
                                {# Placeholder por defecto si get_featured_image devolvió None #}
                                 <img src="{% static 'imagen/default-service.jpg' %}" class="card-img-top" alt="{{ item.category.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                            {% endif %}
                        </div>
                    {% endwith %}
                    <div class="card-body">
                        <h5 class="card-title">{{ item.category.name }}</h5>
                        <p class="card-text">{{ item.category.description }}</p>
                        {% if item.service %} {# Comprobación por si acaso item.service fuera None #}
                        <p class="card-text"><small class="text-muted">Servicio destacado: {{ item.service.name }}</small></p>
                        {% endif %}
                        <a href="{% url 'services:category' item.category.id %}" class="btn btn-primary">Ver categoría</a>
                    </div>
                </div>
            </div>
            {% empty %}
             <div class="col-12">
                 <p class="text-center">No hay categorías de servicio para mostrar.</p>
             </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{% url 'services:service_list' %}" class="btn btn-primary">Ver todos los servicios</a>
        </div>
    </div>
</section>

<!-- Sección ¿Por qué elegirnos? -->
<section class="why-choose-us py-5 bg-light">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-12">
                <h2 class="section-title">¿Por qué elegirnos?</h2>
                <p class="section-subtitle lead">Nos destacamos por la calidad y profesionalismo, En nuestra tienda, nos comprometemos a brindar soluciones confiables, eficientes y personalizadas que se adaptan a las necesidades de cada cliente. Contamos con un equipo altamente capacitado, materiales de primera calidad y una atención al cliente cercana y transparente. Elegirnos es optar por excelencia, puntualidad y resultados garantizados.</p>
            </div>  
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="feature-box text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-medal fa-3x text-primary"></i>
                    </div>
                    <h4 class="section-title">Calidad Garantizada</h4>
                    <p class="lead">Utilizamos los mejores materiales y técnicas para garantizar resultados excepcionales.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="feature-box text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-user-tie fa-3x text-primary"></i>
                    </div>
                    <h4 class="section-title">Personal Capacitado</h4>
                    <p class="lead">Nuestro equipo está formado por profesionales con amplia experiencia en el sector.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="feature-box text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-clock fa-3x text-primary"></i>
                    </div>
                    <h4 class="section-title">Puntualidad y Eficiencia</h4>
                    <p class="lead">Cumplimos con los plazos establecidos y optimizamos nuestros procesos para ser eficientes.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section py-5 bg-primary text-white text-center">
    <div class="container">
        <h2 class="mb-4">¿Listo para transformar tu espacio?</h2>
        <p class="mb-4">Contáctanos ahora y recibe una cotización personalizada para tus necesidades.</p>
        <a href="{% url 'services:contacto' %}" class="btn btn-light btn-lg">Contáctanos Ahora</a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/scripts.js' %}"></script>
{% endblock %}