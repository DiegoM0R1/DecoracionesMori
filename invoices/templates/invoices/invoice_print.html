<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ invoice.get_invoice_type_display }} {{ invoice.series }}-{{ invoice.number }}</title>
    <style>
        @page {
            size: A4;
            margin: 1cm;
        }
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 12px;
            color: #000;
            margin: 0;
            padding: 20px;
        }
        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* --- CABECERA --- */
        .header-container {
            display: table;
            width: 100%;
            margin-bottom: 20px;
        }
        .header-left {
            display: table-cell;
            width: 60%;
            vertical-align: top;
            padding-right: 20px;
        }
        .header-right {
            display: table-cell;
            width: 40%;
            vertical-align: top;
        }

        /* Logo y Empresa */
        .company-name {
            font-size: 24px;
            font-weight: bold;
            color: #1ea5e3; /* El rojo de tu ejemplo Tres Peces */
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        .company-info {
            font-size: 11px;
            line-height: 1.4;
        }

        /* Cuadro de RUC (Estilo SUNAT) */
        .ruc-box {
            border: 2px solid #000;
            text-align: center;
            padding: 15px 0;
        }
        .ruc-number {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .doc-type {
            font-size: 18px;
            font-weight: bold;
            background-color: #eee; /* Fondo gris opcional */
            padding: 5px 0;
            margin: 5px 0;
            display: block;
        }
        .doc-number {
            font-size: 18px;
            margin-top: 10px;
        }

        /* --- CAJAS DE INFORMACI√ìN (Cliente, Fechas) --- */
        .box-container {
            border: 1px solid #000;
            margin-bottom: 10px;
            padding: 5px;
        }
        .info-row {
            display: flex;
            margin-bottom: 4px;
        }
        .label {
            font-weight: bold;
            width: 100px; /* Ancho fijo para etiquetas */
        }
        .value {
            flex: 1;
        }

        /* --- TABLA DE FECHAS (Estilo franja gris) --- */
        .dates-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            border: 1px solid #000;
        }
        .dates-table th {
            background-color: #ccc; /* Gris como la imagen */
            border: 1px solid #000;
            padding: 5px;
            font-size: 11px;
            text-align: center;
        }
        .dates-table td {
            border: 1px solid #000;
            padding: 5px;
            text-align: center;
        }

        /* --- TABLA DE ITEMS --- */
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .items-table th {
            border: 1px solid #000;
            background-color: #ccc;
            padding: 5px;
            font-size: 11px;
        }
        .items-table td {
            border: 1px solid #000;
            padding: 5px;
            font-size: 11px;
        }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        /* --- TOTALES --- */
        .totals-container {
            display: flex;
            justify-content: flex-end;
            margin-top: 10px;
        }
        .totals-table {
            border-collapse: collapse;
            width: 300px;
        }
        .totals-table td {
            padding: 4px;
            border: 1px solid #000;
        }
        .total-label { font-weight: bold; text-align: right; background-color: #f0f0f0; }
        .total-value { text-align: right; }

        /* --- OBSERVACIONES Y FOOTER --- */
        .notes-box {
            border: 1px solid #000;
            padding: 5px;
            margin-top: 10px;
            min-height: 30px;
            font-size: 11px;
        }
        .notes-header {
            background-color: #ccc;
            font-weight: bold;
            padding: 2px 5px;
            display: inline-block;
            border: 1px solid #000;
            border-bottom: none;
        }
        
        /* Botones de impresi√≥n */
        .print-actions {
            text-align: center;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            cursor: pointer;
            background: #4b90f0;
            color: white;
            border: none;
            border-radius: 4px;
        }
        @media print {
            .print-actions { display: none; }
        }
    </style>
</head>
<body>

    <div class="print-actions">
        <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
        <button onclick="window.close()" style="background:#666;">Cerrar</button>
    </div>

    <div class="container">
        
        <div class="header-container">
            <div class="header-left">
                <div style="margin-bottom: 10px;">
                    <img src="https://diegom0r1.github.io/decomoriweb/img/milogo.png" alt="Logo" style="width: 100px;">
                </div>
                
                <div class="company-name">DECORACIONES MORI</div>
                <div class="company-info">
                    <strong>DE: </strong>DECORACIONES MORI<br>
                    Urbanizaci√≥n Mariscal C√°ceres Mz P6 Lt 23<br>
                    San Juan de Lurigancho, Lima<br>
                    Tel√©fono: 987654321<br>
                    Email: lizandro.morih1@gmail.com
                </div>
            </div>

            <div class="header-right">
                <div class="ruc-box">
                    <div class="ruc-number">R.U.C. 10767644430</div>
                    
                    <div class="doc-type">
                        {% if invoice.invoice_type == 'factura' %}
                            FACTURA ELECTR√ìNICA
                        {% else %}
                            BOLETA DE VENTA ELECTR√ìNICA
                        {% endif %}
                    </div>
                    
                    <div class="doc-number">
                        {{ invoice.series }}-{{ invoice.number|stringformat:"08d" }}
                    </div>
                </div>
            </div>
        </div>

        <div class="box-container">
            <div class="info-row">
                <div class="label">Cliente:</div>
                <div class="value">{{ invoice.client.get_full_name|upper }}</div>
            </div>
            <div class="info-row">
                <div class="label">Direcci√≥n:</div>
                <div class="value">
                    {{ invoice.client.address|default:"-"|upper }}
                </div>
            </div>
            <div class="info-row">
                <div class="label">
                    {% if invoice.invoice_type == 'factura' %}RUC:{% else %}DNI:{% endif %}
                </div>
                <div class="value">
                    {% if invoice.invoice_type == 'factura' %}
                        {{ invoice.client.ruc|default:"-" }}
                    {% else %}
                        {{ invoice.client.dni|default:"-" }}
                    {% endif %}
                </div>
                
                <div class="label">F. Pago:</div>
                <div class="value">{{ invoice.get_payment_method_display|upper }}</div>
                
                <div class="label">Vendedor:</div>
                <div class="value">{{ invoice.created_by.first_name|default:"Admin"|upper }}</div>
            </div>
        </div>

        <table class="dates-table">
            <thead>
                <tr>
                    <th>Fecha Emisi√≥n</th>
                    <th>N¬∞ Orden Compra</th> <th>Fecha Vencimiento</th>
                    <th>Tipo Moneda</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{ invoice.date_issued|date:"d/m/Y" }}</td>
                    <td>-</td>
                    <td>{{ invoice.date_issued|date:"d/m/Y" }}</td> <td>SOLES</td>
                </tr>
            </tbody>
        </table>

        {% if invoice.notes %}
        <div style="margin-bottom: 5px;">
            <span style="background:#ccc; padding:2px 5px; border:1px solid #000; font-weight:bold; font-size:10px;">Observaci√≥n</span>
        </div>
        <div style="border:1px solid #000; padding:5px; margin-bottom:15px; font-size:11px;">
            {{ invoice.notes|upper }}
        </div>
        {% endif %}

        <table class="items-table">
            <thead>
                <tr>
                    <th width="5%">N¬∞</th>
                    <th width="10%">Cant.</th>
                    <th width="10%">U.M.</th>
                    <th width="55%">Descripci√≥n</th>
                    <th width="10%">P.U.</th>
                    <th width="10%">Importe</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="text-center">{{ forloop.counter }}</td>
                    <td class="text-center">{{ item.quantity|floatformat:0 }}</td>
                    <td class="text-center">
                        {% if item.item_type == 'service' %}SERV{% else %}UND{% endif %}
                    </td>
                    <td>{{ item.description|upper }}</td>
                    <td class="text-right">{{ item.unit_price|floatformat:2 }}</td>
                    <td class="text-right">{{ item.subtotal|floatformat:2 }}</td>
                </tr>
                {% endfor %}
                
                {% for i in "123" %} 
                {% if items|length < 3 %}
                <tr style="height: 20px;">
                    <td></td><td></td><td></td><td></td><td></td><td></td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>

        <div class="totals-container">
            <table class="totals-table">
                <tr>
                    <td class="total-label">OP. GRAVADA</td>
                    <td class="total-value">{{ invoice.subtotal|floatformat:2 }}</td>
                </tr>
                <tr>
                    <td class="total-label">I.G.V. 18%</td>
                    <td class="total-value">{{ invoice.igv|floatformat:2 }}</td>
                </tr>
                <tr>
                    <td class="total-label">IMPORTE TOTAL</td>
                    <td class="total-value" style="font-weight:bold;">S/ {{ invoice.total|floatformat:2 }}</td>
                </tr>
            </table>
        </div>

        <div style="margin-top: 30px; font-size: 10px; text-align: center; border-top: 1px solid #ccc; padding-top:10px;">
            Representaci√≥n impresa de la {{ invoice.get_invoice_type_display|upper }} ELECTR√ìNICA.<br>
            Consulte su documento en www.decoracionesmori.com
        </div>

    </div>
</body>
</html>